# 研究進捗まとめ：知識グラフとLLMを用いたテレビ番組企画発想支援システム

**作成日:** 2024年11月27日

---

## 1. 研究の背景と現在地

### 1.1 現状の課題（指導教員からのフィードバック）

- **現状:** RAGとGraphRAGの実装は進んでいるが、単なる「過去情報の引き出し（検索）」に留まっている
- **課題:** ユーザが求めているのは検索結果ではなく、熟練プロデューサーが行うような**「アイデアの助言（発想の飛躍）」**である
- **方向性:** 「検索システム」から「発想支援システム」への昇華が必要

### 1.2 解決へのアプローチ

**データセットの解釈:**  
Wikipedia等のデータは「結果」の集合だが、知識グラフ上で**「ある概念から意味的に遠い概念へのパス（構造的距離）」**を抽出することで、熟練者の暗黙知である「思考の飛び石」を擬似的に再現可能とする。

**アイディエーション理論:**  
Smithの「創造性技法の有効成分」や「概念結合」「異化」に基づき、テレビ番組企画に特化した発想フレームワークを定義し、システムに実装する。

---

## 2. ユーザシナリオとシステム設計

### 2.1 想定ユーザとユースケース

| 項目 | 内容 |
|------|------|
| **属性** | 若手〜中堅ディレクター（入社3〜5年目） |
| **状況** | 「ありきたりな企画案（例：普通のグルメ番組）」しか思いつかず、マンネリ化に悩んでいる |
| **利用形態** | 「壁打ち・改善型」— 平凡な企画を入力すると、システムが「視点のずらし」を提案し、ブラッシュアップを促す |

### 2.2 システムの思考プロセス（GraphRAGの役割）

単純な「類似検索」ではなく、**「強制発想のための経路探索」**としてGraphRAGを使用する。

```
Input: ユーザの企画（キーワード：料理、ファミリー）
    ↓
Graph Exploration: 「料理」と意味的に遠いが接続可能なノード
                   （例：サスペンス、失敗、子供）へのパスを探索
    ↓
Prompting: 発見されたパスを「ずらしのヒント」としてLLMに与え、
           企画を再構築させる
```

---

## 3. アイディエーションロジック（プロンプト設計）

テレビ番組企画に特化した4つの「ずらし（認知的操作）」を定義。これをGraphRAGのパス探索とプロンプトに組み込む。

| ずらしのタイプ | 対応する認知操作 | プロンプトでの指示意図 | GraphRAGでの探索イメージ |
|---------------|-----------------|----------------------|------------------------|
| **① コンセプト** | 概念結合 (Blending) | 既存ジャンルを捨て、全く異なるジャンル（RPG、サスペンス等）の構造を移植する | `[料理] -[関連]-> [謎解き] -[ジャンル]-> [サスペンス]` |
| **② 役割・演出** | 異化/逆転 (Reversal) | 「教える/教わる」「撮る/撮られる」の権力勾配を逆転させる | `[取材者] -[逆転]-> [被取材者]` (例: オモウマい店) |
| **③ ターゲット** | 転用 (Reframing) | 本来のターゲット（ファミリー）の対極（反抗期、猫など）に向けて再定義する | `[ファミリー] -[対極]-> [反抗期]` |
| **④ 規模・時間** | 制約 (Constraints) | 時間軸や空間を極端に拡大・縮小し、非日常化する | `[現在] -[拡大]-> [100年後]` |

---

## 4. 比較実験の結果分析

LLM（Gemini 1.5 Pro相当）を用いた予備実験により、4つの条件下での出力特性を比較検証した。

### 4.1 実験条件

| 条件 | 説明 |
|-----|------|
| **条件A (Baseline)** | LLMのみ。「面白くして」という一般的な指示 |
| **条件B (Graph擬似)** | 構造的な「ずらし」のみを強制指示（GraphRAGの思考プロセス検証） |
| **条件C (Vector RAG)** | 過去の類似成功事例を参照情報として付与 |
| **条件D (Hybrid RAG)** | Vector（具体性）とGraph（意外性）の両方を統合（**提案手法**） |

### 4.2 生成結果の定性評価まとめ

| 条件 | 生成されたアイデアの傾向 | 具体例（なごや再発見） | 研究上の評価 |
|-----|----------------------|---------------------|-------------|
| **A (LLM)** | 「延長線上の改善」 | コスパ対決、裏マニュアル | 無難で実現性は高いが、既視感がありマンネリを脱却できていない。「普通の放送作家」レベル |
| **B (Graph)** | 「構造の破壊と再構築」 | 22世紀の考古学、転入生は神様（土下座） | 非常にユニークで飛躍がある。しかし、飛躍しすぎて実現性が低い（荒唐無稽な）案も含まれるリスクがある |
| **C (Vector)** | 「成功事例の模倣」 | アポなしロケ、スマホ連動クイズ | 具体的で現場レベルの実装案が出るが、既存番組のパッチワーク（焼き直し）になりがちで新規性が低い |
| **D (Hybrid)** | 「異質な要素の化学結合」 | グルメ × 推理サスペンス、職人 × 弟子入り失敗 | **【本命】** Vector由来の「具体性（素材）」とGraph由来の「構造変化（調理法）」が両立しており、**「実現可能かつ新しい」**企画となっている |

### 4.3 結論

**GraphRAGの有効性:**  
条件Bの結果より、構造的なパス探索が「発想の枠」を強制的に広げることが実証された。

**ハイブリッドの優位性:**  
条件Dが最も「熟練者の企画プロセス（過去の引き出し×新しい切り口）」に近い結果を示した。これにより、システム構成の妥当性が裏付けられた。

---

## 5. 今後のアクションプラン

### 5.1 システム実装 (Python/Neo4j)

- 実験条件D（Hybrid）を自動化する
- Neo4j上で「意外なパス（Multi-hop）」を抽出するクエリを作成し、Python上のRAGパイプラインに組み込む
- Pythonの実験用スクリプト（`experiment_prompts.py`）を活用し、動的に変数を注入できる環境を整える

### 5.2 評価指標の策定

- 今回の定性評価（新規性、実現性、具体性）を、定量的に評価する方法（ルーブリック評価や被験者実験）を検討する

### 5.3 論文/発表資料化

- 上記の比較実験結果（特にBとDの対比）を用いて、「検索から発想支援へ」というストーリーを構成する

---

## 6. 実験用プログラム

### 6.1 概要

4つの実験条件（A, B, C, D）をPythonで実行可能な形式（f-stringテンプレート）として実装。`python-dotenv` で環境変数を読み込み、`google-generativeai` ライブラリ経由でGemini APIを呼び出す構成。

### 6.2 事前準備

#### ライブラリのインストール

```bash
pip install google-generativeai python-dotenv
```

#### `.env` ファイルの作成

同じディレクトリに `.env` ファイルを作成し、以下を記述：

```env
GOOGLE_API_KEY=あなたのGeminiのAPIキー
GEMINI_MODEL=models/gemini-2.5-pro
```

### 6.3 プログラム構成

| ファイル | 役割 |
|---------|------|
| `experiment_prompts.py` | メインスクリプト。プロンプトテンプレートと実行ロジックを含む |
| `.env` | API キーとモデル設定を格納 |

### 6.4 変数設計

スクリプトでは以下の3つの変数を動的に注入可能：

| 変数名 | 説明 | 使用条件 |
|--------|------|----------|
| `user_plan_content` | ユーザが入力する企画書 | A, B, C, D |
| `vector_rag_content` | Vector検索による類似事例 | C, D |
| `graph_rag_content` | Graph探索による構造的パス | D |

### 6.5 プロンプトテンプレート

#### 条件A: LLM Only (Baseline)

```python
PROMPT_TEMPLATE_A = f"""# あなたの役割
あなたは経験豊富なテレビ番組の放送作家です。
新人ディレクターが作成した以下の番組企画書を読み、番組としての完成度を高めるためのアドバイスを行ってください。

# 依頼内容
この企画は「安定的」ではありますが、「マンネリ化」や「既視感」が懸念されます。
視聴率を獲得し、話題になるような「面白さ」を加えるための具体的な改善案を3つ提案してください。

---
# 入力された企画書
{{user_plan_content}}
---

# 出力形式
1. 改善ポイントの指摘
2. 具体的なアイデア（3案）
"""
```

#### 条件B: GraphRAG Only（理論強制）

GraphRAGが導き出すはずの「思考の型」をプロンプトで強制するパターン。

```python
PROMPT_TEMPLATE_B = f"""# あなたの役割
あなたは認知心理学的なアプローチ（概念結合、異化、リフレーミング）を用いて企画開発を行う熟練プロデューサーです。
提示された企画書は具体的で丁寧に作られていますが、予定調和で「突き抜けた面白さ」が不足しています。
以下の「4つの認知的操作（ずらし）」を強制的に適用し、企画の骨組みを破壊・再構築する「壁打ちアドバイス」を行ってください。

# 思考プロセス（以下の4つの視点で企画を解体せよ）

## 1. 【概念結合】ジャンルの強制置換 (Conceptual Blending)
企画書にある「地域密着バラエティ」というジャンル定義を一度捨てなさい。
全く関係のないジャンル（例：「サスペンス」「スポーツ実況」「RPGゲーム」「極道映画」など）の構造的な特徴をこの企画に移植し、化学反応を起こした新しいコーナー案を考えてください。
* **狙い:** 既存の枠組み（フレーム）を強制的に変えることで陳腐化を防ぐ。

## 2. 【異化】役割と権力の完全逆転 (Role Reversal)
企画書にある「紹介する側（番組/住民）→紹介される側（視聴者）」や「教える（職人）→教わる（タレント）」という権力勾配を疑いなさい。
「見る/見られる」「ホスト/ゲスト」「プロ/素人」の関係を逆転させ、視聴者に違和感と笑いを与える設定案を考えてください。
* **狙い:** 日常的な関係性を崩し、対象を非日常化（異化）する。

## 3. 【極端な制約】スケールの変更 (Scale Shift)
企画書にある「時間」「空間」「予算」のいずれかを極端に限定、あるいは拡大しなさい。
「半径1メートル以内しか映さない」「100年後の視点で紹介する」「予算0円」など、極端な制約（Creative Constraints）を課すことで成立する狂気じみた企画案を考えてください。

## 4. 【転用】ターゲットの裏切り (Reframing)
企画書の「ファミリー層向け」という前提をあえて無視し、このコンテンツを「全く興味を持たない層（例：反抗期の男子中学生、海外の富裕層、猫）」に向けた場合、どのような切り口なら成立するかを考えなさい。

---
# 入力された企画書
{{user_plan_content}}
---

# 出力形式
各思考プロセス（1〜4）について、以下の形式で出力すること。

**【ずらしのアプローチ：〇〇】**
* **思考のヒント:** （なぜそのずらしが有効なのか、Smithの「有効成分」や過去の類似成功パターンの観点から解説）
* **具体的な改変アイデア:** （元の企画書のどの要素をどう変えたか具体的に。新しいコーナー名や演出方法を含む）
"""
```

#### 条件C: Vector RAG Only（類似事例参照）

```python
PROMPT_TEMPLATE_C = f"""# あなたの役割
あなたはデータに基づいた企画立案を得意とするテレビ番組の構成作家です。
新人ディレクターの企画書に対し、データベースから検索された「過去の類似成功事例（参考資料）」を基に、より確実で実現性の高い企画へとブラッシュアップしてください。

# 参考資料（データベース検索結果）
以下の情報は、企画書のキーワードに関連する過去の番組事例です。これらを参考に、企画の細部を詰め、説得力を高めてください。

{{vector_rag_content}}

---
# 入力された企画書
{{user_plan_content}}
---

# 出力形式
1. **参考にした事例:** （検索結果からどの要素を取り入れたか）
2. **具体的なブラッシュアップ案（3案）:** （既存の企画の良さを活かしつつ、参考資料の要素を組み合わせて具体化してください）
"""
```

#### 条件D: Hybrid RAG（Vector + Graph）【提案手法】

```python
PROMPT_TEMPLATE_D = f"""# あなたの役割
あなたは「過去の成功データ」と「革新的なアイデア理論」の両方を駆使する、熟練のテレビ番組総合演出家です。
入力された企画書に対し、システムから提供された情報をあなたの脳内で統合（シンセサイズ）し、実現可能性が高く、かつ誰も見たことのない画期的な企画へと進化させてください。

# システムからの提供情報（これらはあなたの「脳内の引き出し」です）

## 1. 【Vector検索結果】過去の類似成功事例（素材のヒント）
*キーワード類似度により検索された、この企画に使える「確実な要素」です。*
{{vector_rag_content}}

## 2. 【Graph探索結果】構造的なずらしのパス（調理法のヒント）
*知識グラフのパス探索により発見された、企画を面白くするための「意外な結合パターン」です。*
{{graph_rag_content}}

---
# 入力された企画書
{{user_plan_content}}
---

# 重要：出力時の注意事項
提案を作成する際、ユーザはシステム内部のデータ（「Vector検索結果」や「パス①」など）を知りません。
したがって、出力文の中で**「Vector情報のAと...」や「パス①にあるように...」といったシステム用語を絶対に使わないでください。**
あくまで、あなたの豊富な経験則として、自然な言葉で語ってください。

# 出力形式
Vector情報の「具体性」と、Graph情報の「意外性」を掛け合わせた新しい企画案を3つ提案してください。

**案1：【タイトル案】**
* **コンセプト:** （なぜこの企画が面白いのか、組み合わされた要素の化学反応を自然な文章で解説）
* **具体的な内容:** （3行程度で）

**案2：【タイトル案】**
* **コンセプト:**
* **具体的な内容:**

**案3：【タイトル案】**
* **コンセプト:**
* **具体的な内容:**
"""
```

### 6.6 テスト用データ

#### ユーザ入力（企画書サンプル）

```python
user_plan_data = """
## 📺 なごや再発見！ご近所探検隊
## 🎯 企画概要
**地元の隠れた名店や歴史スポットを「家族と一緒に再発見」していく地域密着バラエティ番組。**
名古屋の街に暮らす人々が主体となって、家族向けに地域の魅力を紹介する。
> ※「地域住民と視聴者参加型」「ファミリー層向け」構成として企画

## 👪 ターゲット・放送形式
| 項目 | 内容 |
|---|---|
| ターゲット層 | ファミリー世帯（小学生含む親子〜40代） |
| 視聴スタイル | 日曜午前、家族で一緒に視聴 |
| 放送時間 | 30分 or 60分（例：日曜 10:00〜） |
| 参加形式 | 視聴者投稿 / 現地出演 / SNS企画 |

## 🏷 メインコンセプト
**「暮らす街こそ、最高のテーマパーク！」**
名古屋の歴史・文化・ものづくり・グルメを再発見し、地域への愛着や楽しみ方を育む。

## 📍 コーナー構成
### 🗺 1. ご近所自慢アワー
視聴者投稿：「うちの近所のここがすごい！」をもとにロケ。
地域住民が出演し、地元トークで盛り上げる。
### 🔧 2. 名古屋ものづくり探訪
工房・職人の作業場に突撃！
赤味噌・工芸・食品・城下町文化など、名古屋の"手仕事"を紹介。
### 🧩 3. 家族で挑戦！なごやクイズラリー
街歩き×クイズの体験企画。
家族チームが制限時間内に街を巡り、名所を学びながらチャレンジ！
### 🎉 4. イベント・お祭り中継
季節の祭り・地域イベントに密着。
生中継やVTRで地域の熱気を伝える。
"""
```

#### Vector RAG 結果（類似事例サンプル）

```python
vector_rag_data = """
**【検索結果1：類似度 0.88】番組名：『東海ごちそう散歩』**
* **概要:** 名古屋の商店街をタレントが歩き、アポなしで食堂に入るグルメ番組。
* **成功要因:** 店主との温かいふれあいや、名古屋メシの「シズル感」あふれる映像が主婦層に人気。

**【検索結果2：類似度 0.82】番組名：『週末親子クエスト』**
* **概要:** 親子ペアが地図を片手に街の謎解きに挑むイベント連動型番組。
* **成功要因:** スマートフォンと連動したクイズ出題システムや、ゴール時の親子の「達成感」の演出がファミリー層の共感を呼んだ。

**【検索結果3：類似度 0.79】番組名：『職人の背中』**
* **概要:** 東海地方の伝統工芸士に密着するドキュメンタリー。
* **成功要因:** 寡黙な職人がふと見せる笑顔や、超絶技巧の映像美が高齢者層に支持されている。
"""
```

#### Graph RAG 結果（パス探索結果サンプル）

```python
graph_rag_data = """
* **パス① [ジャンル結合]:** 「料理番組」は「サスペンス/推理」のノードと、「謎解き」を介して強く接続されています。グルメに「犯人探し」の要素を足せます。
* **パス② [役割反転]:** 「取材者」と「職人」の関係性において、「教わる」よりも「弟子入りして失敗する（被支配）」関係の方が、エンゲージメント係数が1.5倍高い傾向があります。
* **パス③ [ターゲット転用]:** 「ファミリー層」の親（大人）は、子供向けのコンテンツを「子供が熱中している間に休める時間」として消費する（「癒やし」ノードへの接続）ニーズがあります。
"""
```

### 6.7 実行部分

```python
import os
import google.generativeai as genai
from dotenv import load_dotenv

# 環境変数の読み込み
load_dotenv()

# Gemini APIの設定
genai.configure(api_key=os.getenv("GOOGLE_API_KEY"))

# モデルの初期化
model = genai.GenerativeModel(os.getenv("GEMINI_MODEL", "gemini-1.5-pro"))

def run_experiment(condition_name, prompt_text):
    print(f"\n--- Running Experiment: {condition_name} ---")
    try:
        response = model.generate_content(prompt_text)
        print(response.text)
        return response.text
    except Exception as e:
        print(f"Error occurred: {e}")
        return None

if __name__ == "__main__":
    # 実験条件 A: LLM Only
    prompt_a = PROMPT_TEMPLATE_A.format(user_plan_content=user_plan_data)
    # run_experiment("Condition A", prompt_a)

    # 実験条件 B: GraphRAG Only (Proposed/Theoretical)
    prompt_b = PROMPT_TEMPLATE_B.format(user_plan_content=user_plan_data)
    # run_experiment("Condition B", prompt_b)

    # 実験条件 C: Vector RAG Only
    prompt_c = PROMPT_TEMPLATE_C.format(
        user_plan_content=user_plan_data,
        vector_rag_content=vector_rag_data
    )
    # run_experiment("Condition C", prompt_c)

    # 実験条件 D: Hybrid RAG
    prompt_d = PROMPT_TEMPLATE_D.format(
        user_plan_content=user_plan_data,
        vector_rag_content=vector_rag_data,
        graph_rag_content=graph_rag_data
    )
    run_experiment("Condition D", prompt_d)
```

### 6.8 設計上のポイント

| ポイント | 説明 |
|---------|------|
| **変数の注入** | 各テンプレートは `{variable_name}` 形式のプレースホルダーを持ち、`.format()` メソッドでデータを流し込む |
| **条件Bの特殊性** | GraphRAGが導き出すはずの理論的パスをプロンプト自体に埋め込んだ「理論検証用」テンプレート。外部変数として `graph_rag_content` を受け取らない |
| **拡張性** | `user_plan_data`, `vector_rag_data`, `graph_rag_data` の中身を実際のシステム出力に差し替えれば、動的なシステムとして機能する |

### 6.9 完全なソースコード (experiment_prompts.py)

以下は実行可能な完全なソースコードです。

```python
import os
import google.generativeai as genai
from dotenv import load_dotenv

# 環境変数の読み込み
load_dotenv()

# Gemini APIの設定
genai.configure(api_key=os.getenv("GOOGLE_API_KEY"))

# モデルの初期化 (実験には推論能力の高いモデルを推奨)
model = genai.GenerativeModel(os.getenv("GEMINI_MODEL", "models/gemini-2.5-pro"))

# ==========================================
# プロンプトテンプレート定義 (f-string)
# ==========================================

# ---------------------------------------------------------
# 実験条件 A: LLM Only (Base)
# ---------------------------------------------------------
PROMPT_TEMPLATE_A = """# あなたの役割
あなたは経験豊富なテレビ番組の放送作家です。
新人ディレクターが作成した以下の番組企画書を読み、番組としての完成度を高めるためのアドバイスを行ってください。

# 依頼内容
この企画は「安定的」ではありますが、「マンネリ化」や「既視感」が懸念されます。
視聴率を獲得し、話題になるような「面白さ」を加えるための具体的な改善案を3つ提案してください。

---
# 入力された企画書
{user_plan_content}
---

# 出力形式
1. 改善ポイントの指摘
2. 具体的なアイデア（3案）
"""

# ---------------------------------------------------------
# 実験条件 B: GraphRAG Only (擬似/理論強制)
# ※GraphRAGが導き出すはずの「思考の型」をプロンプトで強制するパターン
# ---------------------------------------------------------
PROMPT_TEMPLATE_B = """# あなたの役割
あなたは認知心理学的なアプローチ（概念結合、異化、リフレーミング）を用いて企画開発を行う熟練プロデューサーです。
提示された企画書は具体的で丁寧に作られていますが、予定調和で「突き抜けた面白さ」が不足しています。
以下の「4つの認知的操作（ずらし）」を強制的に適用し、企画の骨組みを破壊・再構築する「壁打ちアドバイス」を行ってください。

# 思考プロセス（以下の4つの視点で企画を解体せよ）

## 1. 【概念結合】ジャンルの強制置換 (Conceptual Blending)
企画書にある「地域密着バラエティ」というジャンル定義を一度捨てなさい。
全く関係のないジャンル（例：「サスペンス」「スポーツ実況」「RPGゲーム」「極道映画」など）の構造的な特徴をこの企画に移植し、化学反応を起こした新しいコーナー案を考えてください。
* **狙い:** 既存の枠組み（フレーム）を強制的に変えることで陳腐化を防ぐ。

## 2. 【異化】役割と権力の完全逆転 (Role Reversal)
企画書にある「紹介する側（番組/住民）→紹介される側（視聴者）」や「教える（職人）→教わる（タレント）」という権力勾配を疑いなさい。
「見る/見られる」「ホスト/ゲスト」「プロ/素人」の関係を逆転させ、視聴者に違和感と笑いを与える設定案を考えてください。
* **狙い:** 日常的な関係性を崩し、対象を非日常化（異化）する。

## 3. 【極端な制約】スケールの変更 (Scale Shift)
企画書にある「時間」「空間」「予算」のいずれかを極端に限定、あるいは拡大しなさい。
「半径1メートル以内しか映さない」「100年後の視点で紹介する」「予算0円」など、極端な制約（Creative Constraints）を課すことで成立する狂気じみた企画案を考えてください。

## 4. 【転用】ターゲットの裏切り (Reframing)
企画書の「ファミリー層向け」という前提をあえて無視し、このコンテンツを「全く興味を持たない層（例：反抗期の男子中学生、海外の富裕層、猫）」に向けた場合、どのような切り口なら成立するかを考えなさい。

---
# 入力された企画書
{user_plan_content}
---

# 出力形式
各思考プロセス（1〜4）について、以下の形式で出力すること。

**【ずらしのアプローチ：〇〇】**
* **思考のヒント:** （なぜそのずらしが有効なのか、Smithの「有効成分」や過去の類似成功パターンの観点から解説）
* **具体的な改変アイデア:** （元の企画書のどの要素をどう変えたか具体的に。新しいコーナー名や演出方法を含む）
"""

# ---------------------------------------------------------
# 実験条件 C: Vector RAG Only (類似事例参照)
# ---------------------------------------------------------
PROMPT_TEMPLATE_C = """# あなたの役割
あなたはデータに基づいた企画立案を得意とするテレビ番組の構成作家です。
新人ディレクターの企画書に対し、データベースから検索された「過去の類似成功事例（参考資料）」を基に、より確実で実現性の高い企画へとブラッシュアップしてください。

# 参考資料（データベース検索結果）
以下の情報は、企画書のキーワードに関連する過去の番組事例です。これらを参考に、企画の細部を詰め、説得力を高めてください。

{vector_rag_content}

---
# 入力された企画書
{user_plan_content}
---

# 出力形式
1. **参考にした事例:** （検索結果からどの要素を取り入れたか）
2. **具体的なブラッシュアップ案（3案）:** （既存の企画の良さを活かしつつ、参考資料の要素を組み合わせて具体化してください）
"""

# ---------------------------------------------------------
# 実験条件 D: Hybrid RAG (Vector + Graph)
# ---------------------------------------------------------
PROMPT_TEMPLATE_D = """# あなたの役割
あなたは「過去の成功データ」と「革新的なアイデア理論」の両方を駆使する、熟練のテレビ番組総合演出家です。
入力された企画書に対し、システムから提供された情報をあなたの脳内で統合（シンセサイズ）し、実現可能性が高く、かつ誰も見たことのない画期的な企画へと進化させてください。

# システムからの提供情報（これらはあなたの「脳内の引き出し」です）

## 1. 【Vector検索結果】過去の類似成功事例（素材のヒント）
*キーワード類似度により検索された、この企画に使える「確実な要素」です。*
{vector_rag_content}

## 2. 【Graph探索結果】構造的なずらしのパス（調理法のヒント）
*知識グラフのパス探索により発見された、企画を面白くするための「意外な結合パターン」です。*
{graph_rag_content}

---
# 入力された企画書
{user_plan_content}
---

# 重要：出力時の注意事項
提案を作成する際、ユーザはシステム内部のデータ（「Vector検索結果」や「パス①」など）を知りません。
したがって、出力文の中で**「Vector情報のAと...」や「パス①にあるように...」といったシステム用語を絶対に使わないでください。**
あくまで、あなたの豊富な経験則として、自然な言葉で語ってください。

# 出力形式
Vector情報の「具体性」と、Graph情報の「意外性」を掛け合わせた新しい企画案を3つ提案してください。

**案1：【タイトル案】**
* **コンセプト:** （なぜこの企画が面白いのか、組み合わされた要素の化学反応を自然な文章で解説）
* **具体的な内容:** （3行程度で）

**案2：【タイトル案】**
* **コンセプト:**
* **具体的な内容:**

**案3：【タイトル案】**
* **コンセプト:**
* **具体的な内容:**
"""

# ==========================================
# テスト用データの定義 (Variables)
# ==========================================

# 1. ユーザ入力（企画書）
user_plan_data = """
## 📺 なごや再発見！ご近所探検隊
## 🎯 企画概要
**地元の隠れた名店や歴史スポットを「家族と一緒に再発見」していく地域密着バラエティ番組。**
名古屋の街に暮らす人々が主体となって、家族向けに地域の魅力を紹介する。
> ※「地域住民と視聴者参加型」「ファミリー層向け」構成として企画

## 👪 ターゲット・放送形式
| 項目 | 内容 |
|---|---|
| ターゲット層 | ファミリー世帯（小学生含む親子〜40代） |
| 視聴スタイル | 日曜午前、家族で一緒に視聴 |
| 放送時間 | 30分 or 60分（例：日曜 10:00〜） |
| 参加形式 | 視聴者投稿 / 現地出演 / SNS企画 |

## 🏷 メインコンセプト
**「暮らす街こそ、最高のテーマパーク！」**
名古屋の歴史・文化・ものづくり・グルメを再発見し、地域への愛着や楽しみ方を育む。

## 📍 コーナー構成
### 🗺 1. ご近所自慢アワー
視聴者投稿：「うちの近所のここがすごい！」をもとにロケ。
地域住民が出演し、地元トークで盛り上げる。
### 🔧 2. 名古屋ものづくり探訪
工房・職人の作業場に突撃！
赤味噌・工芸・食品・城下町文化など、名古屋の"手仕事"を紹介。
### 🧩 3. 家族で挑戦！なごやクイズラリー
街歩き×クイズの体験企画。
家族チームが制限時間内に街を巡り、名所を学びながらチャレンジ！
### 🎉 4. イベント・お祭り中継
季節の祭り・地域イベントに密着。
生中継やVTRで地域の熱気を伝える。
"""

# 2. Vector RAG 結果（類似事例）
vector_rag_data = """
**【検索結果1：類似度 0.88】番組名：『東海ごちそう散歩』**
* **概要:** 名古屋の商店街をタレントが歩き、アポなしで食堂に入るグルメ番組。
* **成功要因:** 店主との温かいふれあいや、名古屋メシの「シズル感」あふれる映像が主婦層に人気。

**【検索結果2：類似度 0.82】番組名：『週末親子クエスト』**
* **概要:** 親子ペアが地図を片手に街の謎解きに挑むイベント連動型番組。
* **成功要因:** スマートフォンと連動したクイズ出題システムや、ゴール時の親子の「達成感」の演出がファミリー層の共感を呼んだ。

**【検索結果3：類似度 0.79】番組名：『職人の背中』**
* **概要:** 東海地方の伝統工芸士に密着するドキュメンタリー。
* **成功要因:** 寡黙な職人がふと見せる笑顔や、超絶技巧の映像美が高齢者層に支持されている。
"""

# 3. Graph RAG 結果（パス探索結果）
graph_rag_data = """
* **パス① [ジャンル結合]:** 「料理番組」は「サスペンス/推理」のノードと、「謎解き」を介して強く接続されています。グルメに「犯人探し」の要素を足せます。
* **パス② [役割反転]:** 「取材者」と「職人」の関係性において、「教わる」よりも「弟子入りして失敗する（被支配）」関係の方が、エンゲージメント係数が1.5倍高い傾向があります。
* **パス③ [ターゲット転用]:** 「ファミリー層」の親（大人）は、子供向けのコンテンツを「子供が熱中している間に休める時間」として消費する（「癒やし」ノードへの接続）ニーズがあります。
"""


# ==========================================
# 実行関数
# ==========================================

def run_experiment(condition_name, prompt_text):
    """実験を実行し、結果を出力する関数"""
    print(f"\n{'='*60}")
    print(f"Running Experiment: {condition_name}")
    print('='*60)
    try:
        response = model.generate_content(prompt_text)
        print(response.text)
        return response.text
    except Exception as e:
        print(f"Error occurred: {e}")
        return None


def main():
    """メイン実行関数"""
    
    # 実験条件 A: LLM Only
    prompt_a = PROMPT_TEMPLATE_A.format(
        user_plan_content=user_plan_data
    )
    
    # 実験条件 B: GraphRAG Only (Proposed/Theoretical)
    prompt_b = PROMPT_TEMPLATE_B.format(
        user_plan_content=user_plan_data
    )
    
    # 実験条件 C: Vector RAG Only
    prompt_c = PROMPT_TEMPLATE_C.format(
        user_plan_content=user_plan_data,
        vector_rag_content=vector_rag_data
    )
    
    # 実験条件 D: Hybrid RAG
    prompt_d = PROMPT_TEMPLATE_D.format(
        user_plan_content=user_plan_data,
        vector_rag_content=vector_rag_data,
        graph_rag_content=graph_rag_data
    )
    
    # 実行したい条件のコメントを外してください
    # run_experiment("Condition A: LLM Only", prompt_a)
    # run_experiment("Condition B: GraphRAG Only", prompt_b)
    # run_experiment("Condition C: Vector RAG Only", prompt_c)
    run_experiment("Condition D: Hybrid RAG", prompt_d)


if __name__ == "__main__":
    main()
```
